#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#       Import library                                                                               #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

using Printf
using Dates

include("config.jl")
include("me.jl")

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#       Main                                                                                         #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

function main()
    open("result/$FILENAME", "w") do f
        println(f, "Date: ", DATE)
        println(f, "Config")
        println(f, "===================================================================================")
    end

    begin_time = time()

    P, _ = map_elites()

    finish_time = time()

    println("===================================================================================")
    println("Finish!")
    println("Time: ", (finish_time - begin_time), " sec")

    open("result/$FILENAME", "a") do f
        println(f, "===================================================================================")
        println(f, "Finish!")
        println(f, "Time: ", (finish_time - begin_time), " sec")
        println(f, "===================================================================================")
        println(f, "Top 10 solutions:")

        I = sort(P.individuals, by = x -> x.fitness, rev = true)[1:10]
        for i in 1:10
            println(f, "Rank ", i, ": ")
            println(f, " Solution: ", I[i].genes)
            println(f, " Fitness:  ", I[i].fitness)
            println(f, " Behavior: ", I[i].behavior)
        end

        println(f, "===================================================================================")
        println(f, "Best solution: ", best_solution.genes)
        println(f, "Best fitness:  ", best_solution.fitness)
        println(f, "Best behavior: ", best_solution.behavior)
        println(f, "===================================================================================")
    end
end

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#       Run                                                                                          #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#

main()

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#
#                                                                                                    #
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~#